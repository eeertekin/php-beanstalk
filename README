1.Install libbeanstalkclient

$ mkdir php-beanstalk
$ cd php-beanstalk/
$ wget https://github.com/bergundy/libbeanstalkclient/tarball/master --no-check-certificate -O - | tar -zxvf -
$ cd bergundy-libbeanstalkclient*
$ mkdir m4
$ sudo ./autogen.sh 
$ sudo echo "/usr/lib" >> /etc/ld.so.conf
$ sudo ldconfig

2.Install php-beanstalk

$ wget https://github.com/nil-zhang/php-beanstalk/tarball/master --no-check-certificate -O - | tar -zxvf -
$ cd nil-zhang-php-beanstalk*
$ phpize
$ ./configure
$ make
$ sudo make install

## PHP 5.3 on Ubuntu 12.04
$ sudo echo 'extension = "beanstalk.so"' >> /etc/php5/conf.d/beanstalk.ini

## PHP x.x (Unknown)
$ sudo echo 'extension = "beanstalk.so"' >> /etc/php.d/beanstalk.ini

$ php -m

3.Using example

-----example.php----------
<?php

    $bsc = new Beanstalk();

    $bsc->addserver($hostname = "127.0.0.1", $port = 11300, $weigth = 10);
    // $bsc->addserver("ip2", 11300);

    $tubes = $bsc->list_tubes();
    print_r($tubes);

    for($i = 0; $i < 10; $i++)
    {
        $key = "key".$i;
        $value = "value".$i;

        $bsc->use($key);
        $bsc->put($key, $value);
        echo "$key\t$value\n";

        $bsc->watch($key);
        $job = $bsc->reserve($key);
        print_r($job);

        if($bsc->bury($job['id'], $key))
            echo "bury ok\n";
        else
            echo "bury failed\n";

        $bsc->kick(100, $key);
        if($bsc->delete($job['id'], $key))
            echo "delete ok\n";
        else
            echo "delete failed \n";

        $bsc->ignore($key);
        echo "\n";
    }

    echo "done\n";

?>

